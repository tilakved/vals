<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Valentine üíñ</title>

    <style>
      * {
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      html,
      body {
        width: 100%;
        max-width: 100%;
      }

      body {
        margin: 0;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #ff9a9e, #fad0c4);
        overflow: hidden;
      }

      .card {
        background: white;
        padding: 40px 30px;
        border-radius: 20px;
        text-align: center;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        max-width: 440px;
        width: 90%;
        z-index: 10;
      }

      .step {
        display: none;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }

      .step.active {
        display: block;
        opacity: 1;
        transform: translateY(0);
      }

      .fade-out {
        opacity: 0 !important;
        transform: translateY(-20px) !important;
        pointer-events: none;
      }

      h1 {
        color: #e63946;
      }

      p {
        color: #555;
        font-size: 1.1rem;
        margin: 20px 0;
      }

      button {
        padding: 12px 26px;
        border: none;
        border-radius: 30px;
        font-size: 1rem;
        cursor: pointer;
        background: #e63946;
        color: white;
        margin-top: 20px;
      }

      button.secondary {
        background: #f1f1f1;
        color: #333;
      }

      .options {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 20px;
      }

      .option {
        padding: 12px;
        border-radius: 12px;
        border: 2px solid #eee;
        cursor: pointer;
      }

      .option.correct {
        border-color: #4caf50;
        background: #e8f5e9;
      }

      .option.wrong {
        border-color: #e63946;
        background: #fdecea;
      }

      #boom {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        font-size: 3.5rem;
        font-weight: bold;
        color: #e63946;
        pointer-events: none;
        z-index: 9999;
        text-align: center;
      }

      .boom-pop {
        animation: boomPop 1s ease-out forwards;
      }

      @keyframes boomPop {
        0% {
          transform: translate(-50%, -50%) scale(0);
          opacity: 0;
        }
        50% {
          transform: translate(-50%, -50%) scale(1.3);
          opacity: 1;
        }
        100% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 1;
        }
      }

      .confetti,
      .firework {
        position: fixed;
        pointer-events: none;
        z-index: 9998;
      }

      .firework {
        width: 6px;
        height: 6px;
        border-radius: 50%;
      }

      /* ---------- CUSTOM ALERT ---------- */
      .alert-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 99999;
      }

      .alert-box {
        background: white;
        padding: 26px 22px;
        border-radius: 18px;
        max-width: 360px;
        width: 90%;
        text-align: center;
        animation: popIn 0.4s ease;
      }

      .alert-box h2 {
        color: #e63946;
        margin-bottom: 12px;
      }

      @keyframes popIn {
        from {
          transform: scale(0.7);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      /* ---------- RESPONSIVE ---------- */
      @media (max-width: 480px) {
        .card {
          padding: 28px 20px;
          max-width: 92%;
        }

        h1 {
          font-size: 1.6rem;
        }

        p {
          font-size: 1rem;
        }

        button {
          width: 100%;
          padding: 14px;
        }

        #finalBtns {
          flex-direction: column !important;
        }

        #boom {
          font-size: 2.4rem;
          padding: 0 16px;
        }
      }
    </style>
  </head>

  <body>
    <div class="card">
      <!-- STEP 1 -->
      <div class="step active" id="step1">
        <h1>Hey Chakudi üíñ</h1>
        <p>I have something important to ask you‚Ä¶</p>
        <button onclick="startMusic(); nextStep(2)">Okay üëÄ</button>
      </div>

      <!-- STEP 2 -->
      <div class="step" id="step2">
        <h1>Quick Memory Check üòè</h1>
        <p id="quizQuestion"></p>
        <div class="options" id="options"></div>
        <button onclick="submitAnswer()">Submit</button>
      </div>

      <!-- STEP 3 -->
      <div class="step" id="step3">
        <h1>Hmm üòå</h1>
        <p>
          Ok, you have come forward enough‚Ä¶<br />but I will ask you one more
          question.
        </p>
        <button onclick="nextStep(4)">I‚Äôm Ready üíï</button>
      </div>

      <!-- STEP 4 -->
      <div class="step" id="step4">
        <h1 id="finalQ">Final Question üíò</h1>
        <p id="finalText">Will you be my Valentine?</p>

        <div
          class="options"
          id="finalBtns"
          style="flex-direction: row; justify-content: center; gap: 20px"
        >
          <button onclick="sayYes()">Yes üíñ</button>
          <button
            class="secondary"
            id="noBtn"
            onmouseover="moveNo(this)"
            ontouchstart="moveNo(this)"
            onclick="moveNo(this)"
          >
            No üôà
          </button>
        </div>
      </div>
    </div>

    <div id="boom">You‚Äôre Mine üòåüíñ</div>

    <!-- CUSTOM ALERT -->
    <div class="alert-overlay" id="alertBox">
      <div class="alert-box">
        <h2>üò§ Hey!</h2>
        <p id="alertMsg"></p>
        <button onclick="closeAlert()">Try Again</button>
      </div>
    </div>

    <audio id="loveSong" loop>
      <source
        src="./Edd_Sheeran_-_Perfect_(mp3.pm).mp3"
        type="audio/mp3"
      />
    </audio>

    <script>
      /* ---------- MUSIC AUTOPLAY ---------- */
      

      let currentStep = 1;
      let quizIndex = 0;
      let correctCount = 0;
      let selected = null;
      let musicStarted = false;
      
      function startMusic() {
        if (musicStarted) return;
        musicStarted = true;
      
        const audio = document.getElementById("loveSong");
        audio.volume = 0;
        audio.play().then(() => {
          let v = 0;
          const fade = setInterval(() => {
            v += 0.04;
            audio.volume = Math.min(v, 0.6);
            if (v >= 0.6) clearInterval(fade);
          }, 200);
        }).catch(() => {});
      }

      const quizPool = [
        {
          q: "Where was our first photo together taken?",
          options: ["Cafe", "Temple", "Home", "Mall"],
          answer: 2,
        },
        {
          q: "Which color dress were you wearing in our first photo?",
          options: ["Blue", "Grey", "Black", "White"],
          answer: 0,
        },
        {
          q: "Who clicked our first photo?",
          options: ["You", "Me", "Friend", "Dushman"],
          answer: 1,
        },
        {
          q: "What color top did I wore in my phone's photo contact?",
          options: ["Black", "Red", "White", "Grey"],
          answer: 2,
        },
      ].sort(() => Math.random() - 0.5);

      function nextStep(n) {
        document
          .getElementById(`step${currentStep}`)
          .classList.remove("active");
        currentStep = n;
        document.getElementById(`step${currentStep}`).classList.add("active");
        if (n === 2) loadQuestion();
      }

      function loadQuestion() {
        const q = quizPool[quizIndex];
        document.getElementById("quizQuestion").innerText = q.q;
        const box = document.getElementById("options");
        box.innerHTML = "";

        q.options.forEach((o, i) => {
          const div = document.createElement("div");
          div.className = "option";
          div.innerText = o;
          div.onclick = () => selectOption(div, i);
          box.appendChild(div);
        });
      }

      function selectOption(el, i) {
        selected = i;
        document
          .querySelectorAll(".option")
          .forEach((o) => (o.style.borderColor = "#eee"));
        el.style.borderColor = "#e63946";
      }

      function submitAnswer() {
        if (selected === null) return;

        const q = quizPool[quizIndex];
        const opts = document.querySelectorAll(".option");

        opts.forEach((o, i) => {
          if (i === q.answer) o.classList.add("correct");
          else if (i === selected) o.classList.add("wrong");
        });

        if (selected === q.answer) correctCount++;

        setTimeout(() => {
          quizIndex++;
          selected = null;

          if (quizIndex < 2) loadQuestion();
          else if (correctCount === 2) nextStep(3);
          else {
            showAlert(
              "I will complain to Mumma regarding you and your stupid memory üò§<br/><br/>TRY AGAIN!"
            );
            quizIndex = 0;
            correctCount = 0;
            quizPool.sort(() => Math.random() - 0.5);
            loadQuestion();
          }
        }, 1200);
      }

      function showAlert(msg) {
        document.getElementById("alertMsg").innerHTML = msg;
        document.getElementById("alertBox").style.display = "flex";
      }

      function closeAlert() {
        document.getElementById("alertBox").style.display = "none";
      }

      function moveNo(btn) {
      // lock positioning once
      if (btn.dataset.moving !== "true") {
        btn.style.position = "fixed";
        btn.style.transition = "left 0.25s ease, top 0.25s ease";
        btn.dataset.moving = "true";
      }
    
      const rect = btn.getBoundingClientRect();
    
      // viewport-safe dimensions (iOS friendly)
      const vw = document.documentElement.clientWidth;
      const vh = document.documentElement.clientHeight;
    
      const padding = 12;
    
      const maxX = vw - rect.width - padding;
      const maxY = vh - rect.height - padding;
    
      // HARD CLAMP
      const x = Math.min(
        maxX,
        Math.max(padding, Math.random() * maxX)
      );
    
      const y = Math.min(
        maxY,
        Math.max(padding, Math.random() * maxY)
      );
    
      btn.style.left = `${x}px`;
      btn.style.top = `${y}px`;
    }

      function sayYes() {
        ["finalQ", "finalText", "finalBtns"].forEach((id) =>
          document.getElementById(id).classList.add("fade-out")
        );

        setTimeout(() => {
          document.getElementById("boom").classList.add("boom-pop");
          launchConfetti();
          sideFireworks();
          createHearts();
        }, 600);
      }

      function launchConfetti() {
        const c = ["#ff4d6d", "#ffd166", "#ff9a9e", "#e63946"];
        for (let i = 0; i < 40; i++) {
          const d = document.createElement("div");
          d.className = "confetti";
          d.style.width = "8px";
          d.style.height = "14px";
          d.style.background = c[Math.floor(Math.random() * c.length)];
          d.style.left = Math.random() * 100 + "vw";
          d.style.top = "-20px";
          document.body.appendChild(d);
          d.animate(
            [{ transform: "translateY(0)" }, { transform: "translateY(110vh)" }],
            { duration: 2500 }
          );
          setTimeout(() => d.remove(), 2500);
        }
      }

      function sideFireworks() {
        const c = ["#ff4d6d", "#ffd166", "#ff9a9e", "#e63946"];
        ["left", "right"].forEach((s) => {
          for (let i = 0; i < 25; i++) {
            const f = document.createElement("div");
            f.className = "firework";
            f.style.background = c[Math.floor(Math.random() * c.length)];
            f.style.top = "50%";
            f.style[s] = "0";
            document.body.appendChild(f);
            const x = s === "left" ? Math.random() * 300 : -Math.random() * 300;
            const y = Math.random() * 300 - 150;
            f.animate(
              [
                { transform: "translate(0,0)" },
                { transform: `translate(${x}px,${y}px)`, opacity: 0 },
              ],
              { duration: 1200 }
            );
            setTimeout(() => f.remove(), 1200);
          }
        });
      }

      function createHearts() {
        for (let i = 0; i < 20; i++) {
          const h = document.createElement("div");
          h.innerText = "‚ù§Ô∏è";
          h.style.position = "fixed";
          h.style.left = Math.random() * 100 + "vw";
          h.style.bottom = "-20px";
          h.style.fontSize = 16 + Math.random() * 20 + "px";
          document.body.appendChild(h);
          h.animate(
            [{ transform: "translateY(0)" }, { transform: "translateY(-120vh)" }],
            { duration: 4000 }
          );
          setTimeout(() => h.remove(), 4000);
        }
      }
    </script>
  </body>
</html>



